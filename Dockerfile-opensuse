FROM boombatower/opensuse:latest
MAINTAINER Mathieu Tarral <mathieu.tarral@gmail.com>

# general dev tools
#--------------------
RUN zypper --non-interactive in git vim

# add simple user
#-----------------
RUN useradd -m docker
RUN zypper --non-interactive in sudo
RUN echo "docker ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# kdesrc-build requirements 
#------------------
# packages
RUN zypper --non-interactive in -f bzr cmake doxygen
RUN zypper --non-interactive in -f perl-libwww-perl perl-XML-Parser perl-JSON dialog 
RUN zypper --non-interactive in -f tar gettext-tools-mini xcb-util-keysyms-devel libxslt-devel libxml2-devel docbook-xsl-stylesheets libudev-mini-devel boost-devel giflib-devel vlc-devel gstreamer-plugins-base-devel
# qt5 repo
RUN zypper ar -f "http://download.opensuse.org/repositories/KDE:/Qt5/openSUSE_13.1/" "Qt5"
RUN zypper --non-interactive --gpg-auto-import-keys refresh
# qt5 packages
RUN zypper --non-interactive in -f libqt4-devel libqt5-qtbase-private-headers-devel libQt5Core-devel libQt5Network-devel libQt5Test-devel libQt5Widgets-devel libQt5Xml-devel libQt5Script-devel libqt5-qtx11extras-devel libqt5-qttools-devel libqt5-qtsvg-devel libqt5-qtquick1-devel libQt5WebKit5-devel libQt5WebKitWidgets-devel libqt5-qtxmlpatterns-devel
# kde anongit url alias
RUN su docker -c 'git config --global url."git://anongit.kde.org/".insteadOf kde:'
# quick fix with bzr and ssl-certs
RUN su docker -c 'mkdir /home/docker/.bazaar && echo -e "[DEFAULT]\n\tssl.cert_reqs=none" > /home/docker/.bazaar/bazaar.conf'

VOLUME /work
RUN chown docker:users /work

ENTRYPOINT "/bin/bash"
